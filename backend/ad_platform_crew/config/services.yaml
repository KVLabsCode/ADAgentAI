# Service Definitions for Ad Platform Control Plane
#
# Each service defines:
# - display_name: Human-readable name
# - module: Python module containing tools
# - capabilities: Grouped tools by function (inventory, reporting, mediation, etc.)
#
# This architecture solves the "154 tools" problem by:
# 1. Only giving agents tools they need for their specific capability
# 2. Filtering tools at agent creation time, not MCP server level
# 3. Allowing easy addition of new services (just add YAML!)

services:
  general:
    display_name: "General Assistant"
    description: "Handles greetings, help requests, and general questions"
    module: null  # No tools needed for general queries

    capabilities:
      assistant:
        description: "Respond to greetings and general questions"
        backstory: >
          Friendly ad platform assistant who helps users understand what's possible.
          Responds naturally to greetings and explains capabilities clearly.
          Keeps responses brief and helpful.
        tools: []

  admob:
    display_name: "AdMob"
    description: "Google AdMob for mobile app monetization"
    module: "ad_platform_crew.tools.admob_tools"

    capabilities:
      # Core inventory management - accounts, apps, ad units
      inventory:
        description: "Manage AdMob accounts, apps, and ad units"
        backstory: >
          Mobile monetization expert with deep AdMob SDK knowledge.
          Specializes in account structure, app registration, and ad unit configuration.
          Works efficiently - only fetches account info when specifically needed.
        tools:
          - list_accounts
          - get_account
          - list_apps
          - create_app
          - list_ad_units
          - create_ad_unit

      # Reporting and analytics
      reporting:
        description: "Generate and analyze AdMob performance reports"
        backstory: >
          Mobile analytics specialist focused on ad revenue metrics.
          Expert at interpreting eCPM, fill rates, and impression data.
          Provides actionable insights backed by specific numbers.
        tools:
          - list_accounts
          - get_account
          - generate_mediation_report
          - generate_network_report
          - generate_campaign_report

      # Mediation group management
      mediation:
        description: "Configure mediation groups and ad sources"
        backstory: >
          Mediation optimization specialist who understands waterfall configuration.
          Expert in ad source prioritization, floor prices, and network integration.
          Ensures optimal competition between ad networks.
        tools:
          - list_accounts
          - list_ad_sources
          - list_adapters
          - list_mediation_groups
          - create_mediation_group
          - update_mediation_group
          - list_ad_unit_mappings
          - create_ad_unit_mapping
          - batch_create_ad_unit_mappings

      # A/B testing and experiments
      experimentation:
        description: "Run A/B experiments on mediation configurations"
        backstory: >
          Experimentation specialist focused on data-driven optimization.
          Designs statistically valid A/B tests for mediation configurations.
          Analyzes experiment results to make informed decisions.
        tools:
          - list_accounts
          - list_mediation_groups
          - create_mediation_ab_experiment
          - stop_mediation_ab_experiment
          - generate_mediation_report

  admanager:
    display_name: "Google Ad Manager"
    description: "Google Ad Manager for web and app inventory"
    module: "ad_platform_crew.tools.admanager_tools"

    capabilities:
      # Core inventory management - ad units, placements, sites
      inventory:
        description: "Manage Ad Manager ad units, placements, and sites"
        backstory: >
          Enterprise ad inventory manager with programmatic expertise.
          Specializes in ad unit hierarchy, placement optimization, and site management.
          Works efficiently - only fetches network info when specifically needed.
        tools:
          - list_networks
          - list_ad_units
          - get_ad_unit
          - create_ad_unit
          - patch_ad_unit
          - list_placements
          - get_placement
          - create_placement
          - list_sites
          - get_site

      # Reporting and analytics
      reporting:
        description: "Generate and analyze Ad Manager reports"
        backstory: >
          Publisher analytics expert specializing in yield optimization.
          Expert at creating custom reports with dimensions and metrics.
          Provides insights on fill rates, CPM trends, and inventory performance.
        tools:
          - list_networks
          - list_reports
          - get_report
          - create_report
          - run_report
          - fetch_report_results

      # Order and line item management
      orders:
        description: "Manage orders and line items"
        backstory: >
          Trafficking specialist with expertise in order management.
          Configures line items, targeting, and delivery settings.
          Ensures campaigns run smoothly and meet delivery goals.
        tools:
          - list_networks
          - list_orders
          - get_order
          - list_line_items
          - get_line_item

      # Deals and programmatic
      deals:
        description: "Manage programmatic deals and private auctions"
        backstory: >
          Programmatic deals negotiator with demand partner relationships.
          Expert in private marketplace deals and preferred deals.
          Optimizes yield through strategic demand partnerships.
        tools:
          - list_networks
          - list_private_auctions
          - get_private_auction
          - create_private_auction
          - list_private_auction_deals
          - get_private_auction_deal

      # Targeting and custom fields
      targeting:
        description: "Manage custom targeting and audience segments"
        backstory: >
          Targeting specialist focused on audience segmentation.
          Expert in custom key-values, audience segments, and geo-targeting.
          Optimizes ad delivery through precise targeting.
        tools:
          - list_networks
          - list_custom_targeting_keys
          - get_custom_targeting_key
          - create_custom_targeting_key
          - list_custom_targeting_values
          - list_audience_segments
          - list_geo_targets

# Capability groupings that span multiple services
cross_platform:
  inventory:
    description: "Unified inventory management across all platforms"
    services: ["admob", "admanager"]

  reporting:
    description: "Unified reporting across all platforms"
    services: ["admob", "admanager"]
